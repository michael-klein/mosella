!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.mosella={})}(this,function(n){var t=Symbol("stream"),r=Symbol("stop"),o=function(n){var o,e=[],i=[];void 0!==n&&i.push(n);var u=function(n,t){var r;t=[].concat(t);var e=function(){o===r&&(o=void 0);var e=function(n,t){var r=function(){if(t.length>0){var o=t.shift()(n);return o instanceof Promise?o.then(function(){return r()}):r()}};return r()}(n,t);e instanceof Promise&&(o=e)};o?(r=o.then(e),o=r):e()},f=function(t){return n!==r&&(void 0!==t&&(n=t),e.length>0?u(t,e):i.push(t),t===r&&(e.length=0,i.length=0)),n};return f.on=function(t){if(n!==r)return e.push(t),i.length>0&&(i=i.filter(function(n){return u(n,e),!1})),function(){e.splice(e.indexOf(t),1)}},f.stop=function(){f(r)},f.hasListeners=function(){return e.length>0},f.is=t,f},e=function(n,t,e){var i,u=e||t.pop(),f=o();return u.on(function(n){n!==r?f(n):i(n)}),i=n.apply(n,t.concat([f]))},i=function(n){return function(){for(var r=[],o=arguments.length;o--;)r[o]=arguments[o];var i=r[r.length-1];return"function"==typeof i&&i.is===t?e(n,r):function(t){return e(n,r,t)}}},u=i(function(n,t){var r=o();return t.on(function(t){var o=n(t);return o instanceof Promise?o.then(function(n){o&&r(t)}):o&&r(t),o}),r}),f=i(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=n.pop(),o=0,e=n;o<e.length;o+=1)r=(0,e[o])(r);return r}),c=i(function(n,t){var r=o();return t.on(function(t){var o=n.apply(n,[t]);return o instanceof Promise?o.then(function(n){return r(n)}):r(o),o}),r}),a=c(function(n){return void 0===this.sum&&(this.sum=0),this.sum+=n});n.stream=o,n.filter=u,n.pipe=f,n.map=c,n.merge=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=o(),e=0,i=n;e<i.length;e+=1)i[e].on(function(n){return r(n)});return r},n.operator=i,n.sum=a,n.combine=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var r=Array(n.length).fill(void 0),e=o();return n.forEach(function(n,t){r[t]=n()}),e(r),n.forEach(function(n,t){n.on(function(n){r[t]=n,e(r)})}),e}});
//# sourceMappingURL=mosella.umd.js.map
