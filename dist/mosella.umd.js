!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.mosella={})}(this,function(n){var t="MOSELLA_STOP",r="MOSELLA_RESET",o=function(n){var o=[],e=[];void 0!==n&&e.push(n);var i,u=n,f=function(n,t){var r;t=[].concat(t);var o=function(){i===r&&(i=void 0);var o=function(n,t){var r=function(){if(t.length>0){var o=t.shift()(n);return o instanceof Promise?o.then(function(){return r()}):r()}};return r()}(n,t);o instanceof Promise&&(i=o)};i?(r=i.then(o),i=r):o()},c=function(i){return n!==t&&void 0!==i&&(void 0!==i&&(n=i),i===r&&(n=u,e=[]),o.length>0?f(i,o):i!==r&&e.push(i),i===t&&(o.length=0,e.length=0)),n};return c.on=function(r){if(n!==t)return o.push(r),e.length>0&&(e=e.filter(function(n){return f(n,o),!1})),function(){o.splice(o.indexOf(r),1)}},c.stop=function(){c(t)},c.reset=function(){c(r)},c.hasListeners=function(){return o.length>0},c.is="MOSELLA_STREAM",c},e=function(n,e,i){var u,f=i||e.pop(),c=o();return f.on(function(n){n!==t&&n!==r?c(n):u(n)}),u=n.apply(n,e.concat([c]))},i=function(n){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var o=t[t.length-1];return"function"==typeof o&&"MOSELLA_STREAM"===o.is?e(n,t):function(r){return e(n,t,r)}}},u=i(function(n,t){var r=o();return t.on(function(t){var o=n(t);return o instanceof Promise?o.then(function(n){o&&r(t)}):o&&r(t),o}),r}),f=i(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=n.pop(),o=0,e=n;o<e.length;o+=1)r=(0,e[o])(r);return r}),c=i(function(n,t){var r=o();return t.on(function(t){var o=n.apply(n,[t]);return o instanceof Promise?o.then(function(n){return r(n)}):r(o),o}),r}),a=c(function(n){return void 0===this.sum&&(this.sum=0),this.sum+=n});n.stream=o,n.filter=u,n.pipe=f,n.map=c,n.merge=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=o(),e=0,i=n;e<i.length;e+=1)i[e].on(function(n){return r(n)});return r},n.operator=i,n.sum=a,n.combine=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];var i=Array(n.length).fill(void 0);n.forEach(function(n,t){i[t]=n()});var u=o(i);return n.forEach(function(n,o){n.on(function(n){n===r||n===t?u(n):(i[o]=n,u([].concat(i)))})}),u}});
//# sourceMappingURL=mosella.umd.js.map
