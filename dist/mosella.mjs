var n=Symbol("stream"),t=Symbol("stop"),r=function(r){var o=[],u=[];void 0!==r&&u.push(r);var e=Promise.resolve(),i=function(n,t){t=[].concat(t);var r=function(){if(t.length>0){var o=t.shift()(n);return o instanceof Promise?o.then(function(){return r()}):r()}};return r()},f=function(n){return r!==t&&(void 0!==n&&(r=n),o.length>0?e=e.then(function(){return i(n,o)}):u.push(n),n===t&&(o.length=0,u.length=0)),r};return f.on=function(n){if(r!==t)return o.push(n),u.length>0&&(u=u.filter(function(n){return e=e.then(function(){return i(n,o)}),!1})),function(){o.splice(o.indexOf(n),1)}},f.stop=function(){f(t)},f.hasListeners=function(){return o.length>0},f.is=n,f},o=function(n,o,u){var e,i=u||o.pop(),f=r();return i.on(function(n){n!==t?f(n):e(n)}),e=n.apply(n,o.concat([f]))},u=function(t){return function(){for(var r=[],u=arguments.length;u--;)r[u]=arguments[u];var e=r[r.length-1];return"function"==typeof e&&e.is===n?o(t,r):function(n){return o(t,r,n)}}},e=u(function(n,t){var o=r();return t.on(function(t){var r=n(t);return r instanceof Promise?r.then(function(n){r&&o(t)}):r&&o(t),r}),o}),i=u(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=n.pop(),o=0,u=n;o<u.length;o+=1)r=(0,u[o])(r);return r}),f=u(function(n,t){var o=r();return t.on(function(t){var r=n.apply(n,[t]);return r instanceof Promise?r.then(function(n){return o(n)}):o(r),r}),o}),c=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var o=r(),u=0,e=n;u<e.length;u+=1)e[u].on(function(n){return o(n)});return o},a=f(function(n){return void 0===this.sum&&(this.sum=0),this.sum+=n}),h=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var o=Array(n.length).fill(void 0),u=r();return n.forEach(function(n,t){n.on(function(n){o[t]=n,u(o)})}),u};export{r as stream,e as filter,i as pipe,f as map,c as merge,u as operator,a as sum,h as combine};
//# sourceMappingURL=mosella.mjs.map
