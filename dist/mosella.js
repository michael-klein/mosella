var n=Symbol("stream"),t=Symbol("stop"),r=function(r){var o,e=[],i=[];void 0!==r&&i.push(r);var u=function(n,t){var r;t=[].concat(t);var e=function(){o===r&&(o=void 0);var e=function(n,t){var r=function(){if(t.length>0){var o=t.shift()(n);return o instanceof Promise?o.then(function(){return r()}):r()}};return r()}(n,t);e instanceof Promise&&(o=e)};o?(r=o.then(e),o=r):e()},f=function(n){return r!==t&&(void 0!==n&&(r=n),e.length>0?u(n,e):i.push(n),n===t&&(e.length=0,i.length=0)),r};return f.on=function(n){if(r!==t)return e.push(n),i.length>0&&(i=i.filter(function(n){return u(n,e),!1})),function(){e.splice(e.indexOf(n),1)}},f.stop=function(){f(t)},f.hasListeners=function(){return e.length>0},f.is=n,f},o=function(n,o,e){var i,u=e||o.pop(),f=r();return u.on(function(n){n!==t?f(n):i(n)}),i=n.apply(n,o.concat([f]))},e=function(t){return function(){for(var r=[],e=arguments.length;e--;)r[e]=arguments[e];var i=r[r.length-1];return"function"==typeof i&&i.is===n?o(t,r):function(n){return o(t,r,n)}}},i=e(function(n,t){var o=r();return t.on(function(t){var r=n(t);return r instanceof Promise?r.then(function(n){r&&o(t)}):r&&o(t),r}),o}),u=e(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=n.pop(),o=0,e=n;o<e.length;o+=1)r=(0,e[o])(r);return r}),f=e(function(n,t){var o=r();return t.on(function(t){var r=n.apply(n,[t]);return r instanceof Promise?r.then(function(n){return o(n)}):o(r),r}),o}),c=f(function(n){return void 0===this.sum&&(this.sum=0),this.sum+=n});exports.stream=r,exports.filter=i,exports.pipe=u,exports.map=f,exports.merge=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var o=r(),e=0,i=n;e<i.length;e+=1)i[e].on(function(n){return o(n)});return o},exports.operator=e,exports.sum=c,exports.combine=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var o=Array(n.length).fill(void 0),e=r();return n.forEach(function(n,t){o[t]=n()}),e(o),n.forEach(function(n,t){n.on(function(n){o[t]=n,e(o)})}),e};
//# sourceMappingURL=mosella.js.map
