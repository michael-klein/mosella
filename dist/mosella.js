var n="MOSELLA_STOP",t="MOSELLA_RESET",r=function(r){var o=[],e=[];void 0!==r&&e.push(r);var i,u=r,f=function(n,t){var r;t=[].concat(t);var o=function(){i===r&&(i=void 0);var o=function(n,t){var r=function(){if(t.length>0){var o=t.shift()(n);return o instanceof Promise?o.then(function(){return r()}):r()}};return r()}(n,t);o instanceof Promise&&(i=o)};i?(r=i.then(o),i=r):o()},c=function(i){return r!==n&&void 0!==i&&(void 0!==i&&(r=i),i===t&&(r=u,e=[]),o.length>0?f(i,o):i!==t&&e.push(i),i===n&&(o.length=0,e.length=0)),r};return c.on=function(t){if(r!==n)return o.push(t),e.length>0&&(e=e.filter(function(n){return f(n,o),!1})),function(){o.splice(o.indexOf(t),1)}},c.stop=function(){c(n)},c.reset=function(){c(t)},c.hasListeners=function(){return o.length>0},c.is="MOSELLA_STREAM",c},o=function(o,e,i){var u,f=i||e.pop(),c=r();return f.on(function(r){r!==n&&r!==t?c(r):u(r)}),u=o.apply(o,e.concat([c]))},e=function(n){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var e=t[t.length-1];return"function"==typeof e&&"MOSELLA_STREAM"===e.is?o(n,t):function(r){return o(n,t,r)}}},i=e(function(n,t){var o=r();return t.on(function(t){var r=n(t);return r instanceof Promise?r.then(function(n){r&&o(t)}):r&&o(t),r}),o}),u=e(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var r=n.pop(),o=0,e=n;o<e.length;o+=1)r=(0,e[o])(r);return r}),f=e(function(n,t){var o=r();return t.on(function(t){var r=n.apply(n,[t]);return r instanceof Promise?r.then(function(n){return o(n)}):o(r),r}),o}),c=f(function(n){return void 0===this.sum&&(this.sum=0),this.sum+=n});exports.stream=r,exports.filter=i,exports.pipe=u,exports.map=f,exports.merge=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];for(var o=r(),e=0,i=n;e<i.length;e+=1)i[e].on(function(n){return o(n)});return o},exports.operator=e,exports.sum=c,exports.combine=function(){for(var o=[],e=arguments.length;e--;)o[e]=arguments[e];var i=Array(o.length).fill(void 0);o.forEach(function(n,t){i[t]=n()});var u=r(i);return o.forEach(function(r,o){r.on(function(r){r===t||r===n?u(r):(i[o]=r,u([].concat(i)))})}),u};
//# sourceMappingURL=mosella.js.map
